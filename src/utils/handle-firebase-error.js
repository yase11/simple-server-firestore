const logging = require("./logging");
const createMessage = require("./message");

/**
 * 
 * @param {String} errorCode error code name ofgenerated by firebase
 * @param {Response} response Response Entity
 */
const handleFirebaseError = async (errorCode, response) => {
    let firebaseError = false;
    try {
        switch (errorCode) {
            case 'auth/id-token-expired':
                response.status(401).send(
                    createMessage(true, 'Token Expired: Unauthorized access')
                );
                firebaseError = true;
                break;
    
            case 'auth/argument-error':
                response.status(401).send(
                    createMessage(true, 'Invalid token: Unauthorized access')
                );
                firebaseError = true;
                break;
    
            case 'auth/email-already-exists':
                response.status(406).send(
                    createMessage(true, 'Email address is already in use by another account')
                );
                firebaseError = true;
                break;
        
            default:
                if (!errorCode) break;
                response.status(500).send(
                    createMessage(true, 'Something went wrong. F1R3B4$3')
                );
                firebaseError = true;

        }
    } catch (error) {
        logging('handle firebase error', error, true);
    }
    return firebaseError;
};

module.exports = handleFirebaseError;